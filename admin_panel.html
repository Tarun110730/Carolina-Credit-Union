<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - CSV Management</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: #333;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }
        .stat-card {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
            border-left: 4px solid #007bff;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #007bff;
        }
        .search-section {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .search-box {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            margin-bottom: 10px;
        }
        .person-list {
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: white;
        }
        .person-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .person-item:last-child {
            border-bottom: none;
        }
        .person-info {
            flex: 1;
        }
        .person-name {
            font-weight: bold;
        }
        .person-details {
            color: #666;
            font-size: 0.9em;
        }
        .status-badge {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 0.8em;
            font-weight: bold;
        }
        .status-available {
            background: #d4edda;
            color: #155724;
        }
        .status-contacted {
            background: #f8d7da;
            color: #721c24;
        }
        .action-buttons {
            display: flex;
            gap: 10px;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 8px 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .btn-danger {
            background-color: #dc3545;
        }
        .btn-danger:hover {
            background-color: #c82333;
        }
        .btn-success {
            background-color: #28a745;
        }
        .btn-success:hover {
            background-color: #218838;
        }
        .sync-section {
            margin: 20px 0;
            padding: 20px;
            background: #e7f3ff;
            border-radius: 8px;
            border-left: 4px solid #007bff;
        }
        .sync-status {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .sync-success {
            background: #d4edda;
            color: #155724;
        }
        .sync-error {
            background: #f8d7da;
            color: #721c24;
        }
        .sync-loading {
            background: #fff3cd;
            color: #856404;
        }
        .bulk-actions {
            margin: 20px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
        }
        .filter-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }
        .filter-tab {
            padding: 8px 16px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 5px;
        }
        .filter-tab.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ðŸ“Š Admin Panel - CSV Management</h1>
        
        <!-- Statistics -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="total-people">-</div>
                <div>Total People</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="available-people">-</div>
                <div>Available</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="contacted-people">-</div>
                <div>Contacted</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="sync-status">-</div>
                <div>Last Sync</div>
            </div>
        </div>

        <!-- Sync Section -->
        <div class="sync-section">
            <h2>ðŸ”„ Sync Management</h2>
            <p>Automatically sync changes to GitHub so everyone sees the latest data.</p>
            <button onclick="syncToGitHub()" id="sync-btn">Sync to GitHub</button>
            <div id="sync-message"></div>
        </div>

        <!-- Search and Filter -->
        <div class="search-section">
            <h2>ðŸ‘¥ People Management</h2>
            <input type="text" class="search-box" id="search-box" placeholder="Search by name, job title, or employer...">
            
            <div class="filter-tabs">
                <div class="filter-tab active" onclick="filterPeople('all')">All People</div>
                <div class="filter-tab" onclick="filterPeople('available')">Available</div>
                <div class="filter-tab" onclick="filterPeople('contacted')">Contacted</div>
            </div>

            <div class="person-list" id="person-list">
                <!-- People will be loaded here -->
            </div>
        </div>

        <!-- Bulk Actions -->
        <div class="bulk-actions">
            <h2>âš¡ Bulk Actions</h2>
            <p>Quick actions for managing multiple people at once.</p>
            <button onclick="exportCSV()" class="btn-success">Export Current Data</button>
            <button onclick="importCSV()" class="btn-success">Import New Data</button>
            <button onclick="resetAllStatus()" class="btn-danger">Reset All Status</button>
        </div>
    </div>

    <script src='people_data.js'></script>
    <script>
        let allPeople = [];
        let filteredPeople = [];
        let currentFilter = 'all';

        // Load data on page load
        window.addEventListener('load', function() {
            loadPeopleData();
            updateStats();
        });

        function loadPeopleData() {
            if (typeof people !== 'undefined') {
                allPeople = people;
                filteredPeople = [...allPeople];
                displayPeople();
            } else {
                console.error('People data not loaded');
                document.getElementById('person-list').innerHTML = '<p style="padding: 20px; color: red;">Error: People data not loaded. Please check if people_data.js exists.</p>';
            }
        }

        function updateStats() {
            const total = allPeople.length;
            const available = allPeople.filter(p => !p['Status'] || p['Status'].trim() === '').length;
            const contacted = total - available;

            document.getElementById('total-people').textContent = total;
            document.getElementById('available-people').textContent = available;
            document.getElementById('contacted-people').textContent = contacted;
            document.getElementById('sync-status').textContent = 'Ready';
        }

        function displayPeople() {
            const container = document.getElementById('person-list');
            container.innerHTML = '';

            filteredPeople.forEach(person => {
                const isContacted = person['Status'] && person['Status'].trim() === 'Reachout Sent';
                const statusClass = isContacted ? 'status-contacted' : 'status-available';
                const statusText = isContacted ? 'Contacted' : 'Available';

                const personDiv = document.createElement('div');
                personDiv.className = 'person-item';
                personDiv.innerHTML = `
                    <div class="person-info">
                        <div class="person-name">${person['Full Name']}</div>
                        <div class="person-details">${person['Job Title']} at ${person['Employer']}</div>
                    </div>
                    <div class="action-buttons">
                        <span class="status-badge ${statusClass}">${statusText}</span>
                        ${isContacted ? 
                            `<button onclick="markAvailable('${person['Full Name']}')" class="btn-success">Mark Available</button>` :
                            `<button onclick="markContacted('${person['Full Name']}')" class="btn-danger">Mark Contacted</button>`
                        }
                    </div>
                `;
                container.appendChild(personDiv);
            });
        }

        function filterPeople(filter) {
            currentFilter = filter;
            
            // Update active tab
            document.querySelectorAll('.filter-tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            // Filter people
            switch(filter) {
                case 'available':
                    filteredPeople = allPeople.filter(p => !p['Status'] || p['Status'].trim() === '');
                    break;
                case 'contacted':
                    filteredPeople = allPeople.filter(p => p['Status'] && p['Status'].trim() === 'Reachout Sent');
                    break;
                default:
                    filteredPeople = [...allPeople];
            }

            displayPeople();
        }

        // Search functionality
        document.getElementById('search-box').addEventListener('input', function(e) {
            const searchTerm = e.target.value.toLowerCase();
            
            let searchResults = allPeople;
            if (currentFilter === 'available') {
                searchResults = allPeople.filter(p => !p['Status'] || p['Status'].trim() === '');
            } else if (currentFilter === 'contacted') {
                searchResults = allPeople.filter(p => p['Status'] && p['Status'].trim() === 'Reachout Sent');
            }

            filteredPeople = searchResults.filter(person => 
                person['Full Name'].toLowerCase().includes(searchTerm) ||
                person['Job Title'].toLowerCase().includes(searchTerm) ||
                person['Employer'].toLowerCase().includes(searchTerm)
            );

            displayPeople();
        });

        function markContacted(name) {
            const person = allPeople.find(p => p['Full Name'] === name);
            if (person) {
                person['Status'] = 'Reachout Sent';
                updateStats();
                displayPeople();
                showMessage(`âœ… Marked ${name} as contacted`, 'success');
            }
        }

        function markAvailable(name) {
            const person = allPeople.find(p => p['Full Name'] === name);
            if (person) {
                person['Status'] = '';
                updateStats();
                displayPeople();
                showMessage(`âœ… Marked ${name} as available`, 'success');
            }
        }

        function syncToGitHub() {
            const btn = document.getElementById('sync-btn');
            const message = document.getElementById('sync-message');
            
            btn.disabled = true;
            btn.textContent = 'Syncing...';
            message.innerHTML = '<div class="sync-status sync-loading">ðŸ”„ Syncing to GitHub...</div>';

            // Simulate sync process (in real implementation, this would call your backend)
            setTimeout(() => {
                // Here you would actually call your sync API
                message.innerHTML = '<div class="sync-status sync-success">âœ… Successfully synced to GitHub!</div>';
                btn.disabled = false;
                btn.textContent = 'Sync to GitHub';
                
                // Update sync status
                document.getElementById('sync-status').textContent = 'Just now';
            }, 2000);
        }

        function exportCSV() {
            // Create CSV content
            let csvContent = 'Class Year,Employer,Employer City,Employer State,Employer Country,Type,Job Title,Full Name,Post-Graduation Email Address,Google Search Query,Reachout Notes,Status\n';
            
            allPeople.forEach(person => {
                csvContent += `2013,${person['Employer']},City,State,USA,Full-Time,${person['Job Title']},${person['Full Name']},email@example.com,${person['Google Search Query']},,${person['Status'] || ''}\n`;
            });

            // Download CSV
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'updated_alumni_data.csv';
            a.click();
            window.URL.revokeObjectURL(url);

            showMessage('âœ… CSV exported successfully', 'success');
        }

        function importCSV() {
            const input = document.createElement('input');
            input.type = 'file';
            input.accept = '.csv';
            input.onchange = function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        // Parse CSV and update data
                        const csv = e.target.result;
                        // Here you would parse the CSV and update the data
                        showMessage('âœ… CSV imported successfully', 'success');
                        loadPeopleData();
                        updateStats();
                    };
                    reader.readAsText(file);
                }
            };
            input.click();
        }

        function resetAllStatus() {
            if (confirm('Are you sure you want to reset all statuses? This will mark everyone as available.')) {
                allPeople.forEach(person => {
                    person['Status'] = '';
                });
                updateStats();
                displayPeople();
                showMessage('âœ… Reset all statuses', 'success');
            }
        }

        function showMessage(text, type) {
            const message = document.getElementById('sync-message');
            const className = type === 'success' ? 'sync-success' : 'sync-error';
            message.innerHTML = `<div class="sync-status ${className}">${text}</div>`;
            
            setTimeout(() => {
                message.innerHTML = '';
            }, 3000);
        }
    </script>
</body>
</html> 