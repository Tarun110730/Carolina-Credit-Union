<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cold Email Prompt Generator (CSV Synced)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1, h2 {
            color: #333;
        }
        .form-group {
            margin-bottom: 20px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input, select, textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        button {
            background-color: #007bff;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .hidden {
            display: none;
        }
        .prompt-output {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin-top: 20px;
            white-space: pre-wrap;
            font-family: monospace;
        }
        .person-info {
            background-color: #e9ecef;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        .sync-status {
            background-color: #d4edda;
            color: #155724;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-size: 14px;
        }
        .google-query-display {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            padding: 15px;
            margin-top: 5px;
        }
        .google-link {
            color: #007bff;
            text-decoration: none;
            word-break: break-all;
            display: inline-block;
            max-width: 100%;
        }
        .google-link:hover {
            text-decoration: underline;
            color: #0056b3;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Cold Email Prompt Generator (CSV Synced)</h1>
        
        <!-- Step 1: User Info Form -->
        <div id="user-form">
        <h2>Step 1: Enter Your Info</h2>
        <div class="form-group">
            <label for="yourName">Your Full Name:</label>
            <input type="text" id="yourName" required>
        </div>
        <div class="form-group">
            <label for="yourYear">Your Year:</label>
            <input type="text" id="yourYear" required placeholder="e.g., senior, junior, sophomore, freshman">
        </div>
        <div class="form-group">
            <label for="yourCollege">Your College in UNC (optional):</label>
            <input type="text" id="yourCollege" placeholder="e.g., Kenan-Flagler Business School">
        </div>
        <button onclick="nextStep()">Continue</button>
    </div>

        <!-- Step 2: Person Selection -->
        <div id="person-selection" class="hidden">
            <h2>Step 2: Select Person</h2>
            <div class="person-info" id="user-info-display"></div>
            <div class="sync-status" id="sync-status">Loading data...</div>
            
            <div class="form-group">
                <label for="personSelect">Select Person:</label>
                <select id="personSelect" required onchange="showPersonDetails()">
                    <option value="">Choose a person...</option>
                </select>
            </div>
            
            <div id="person-details" class="hidden">
                <div class="form-group">
                    <label>Google Search Query:</label>
                    <div class="google-query-display">
                        <a id="google-query-link" href="" target="_blank" class="google-link">Click here to open Google search</a>
                    </div>
                </div>
            </div>
            
            <div class="form-group">
                <label for="googleNotes">Notes from Google Search (optional):</label>
                <textarea id="googleNotes" rows="4" placeholder="Enter any notes you found from researching this person online..."></textarea>
            </div>
            
            <button onclick="generatePrompt()">Generate Prompt</button>
            <button onclick="backToStep1()" style="background-color: #6c757d;">Back</button>
        </div>

        <!-- Step 3: Generated Prompt -->
        <div id="prompt-output" class="hidden">
            <h2>Generated ChatGPT Prompt</h2>
            <div class="prompt-output" id="promptText"></div>
            <button onclick="copyPrompt()">Copy to Clipboard</button>
            <button onclick="startOver()" style="background-color: #6c757d;">Start Over</button>
        </div>
        
    </div>

    <script src='people_data.js'></script>
    <script>
        let currentUser = {};
        let allPeople = [];

        // Add error handling and debugging
        window.onerror = function(msg, url, lineNo, columnNo, error) {
            console.error('JavaScript Error:', msg, 'at', url, 'line', lineNo);
            alert('JavaScript Error: ' + msg + '\nCheck console for details.');
            return false;
        };

        // Check if people data is loaded
        window.addEventListener('load', function() {
            if (typeof people === 'undefined') {
                console.error('people data not loaded');
                alert('Error: People data not loaded. Please check if people_data.js exists.');
            } else {
                allPeople = people;
                console.log('People data loaded successfully:', allPeople.length, 'people');
            }
        });

        function nextStep() {
            try {
                const name = document.getElementById('yourName').value.trim();
                const year = document.getElementById('yourYear').value.trim().toLowerCase();
                const college = document.getElementById('yourCollege').value.trim();

                if (!name || !year) {
                    alert('Please fill in your name and year.');
                    return;
                }

                currentUser = {
                    yourName: name,
                    yourYear: year,
                    yourCollegeinUNC: college
                };

                // Load data and filter out people with "Reachout Sent" status
                loadFilteredData();

                // Show user info
                document.getElementById('user-info-display').textContent = 
                    `User: ${name}, ${year}, ${college || 'UNC Chapel Hill'}`;

                document.getElementById('user-form').classList.add('hidden');
                document.getElementById('person-selection').classList.remove('hidden');
            } catch (error) {
                console.error('Error in nextStep:', error);
                alert('Error: ' + error.message);
            }
        }

        function loadFilteredData() {
            try {
                // Create filtered list for email generator
                const availablePeople = allPeople.filter(p => !p['Status'] || p['Status'].trim() === '');
                
                // Update the global people array reference
                window.availablePeople = availablePeople;
                
                updateDropdown();
                updateSyncStatus();
                
                console.log('Filtered data loaded:', availablePeople.length, 'available people');
            } catch (error) {
                console.error('Error in loadFilteredData:', error);
                alert('Error loading data: ' + error.message);
            }
        }

        function updateDropdown() {
            try {
                const select = document.getElementById('personSelect');
                if (!select) {
                    throw new Error('Person select element not found');
                }
                
                select.innerHTML = '<option value="">Choose a person...</option>';
                
                // Use the filtered available people
                const availablePeople = window.availablePeople || [];
                
                availablePeople.forEach(person => {
                    const option = document.createElement('option');
                    option.value = person['Full Name'];
                    option.textContent = `${person['Full Name']} - ${person['Job Title']} at ${person['Employer']}`;
                    select.appendChild(option);
                });
                
                console.log('Dropdown updated with', availablePeople.length, 'people');
            } catch (error) {
                console.error('Error in updateDropdown:', error);
                alert('Error updating dropdown: ' + error.message);
            }
        }

        function updateSyncStatus() {
            try {
                const statusElement = document.getElementById('sync-status');
                if (!statusElement) {
                    throw new Error('Status element not found');
                }
                
                const totalPeople = allPeople.length;
                const availablePeople = window.availablePeople || [];
                const availableCount = availablePeople.length;
                const contactedCount = totalPeople - availableCount;
                
                statusElement.textContent = `Available: ${availableCount} people, ${contactedCount} marked as "Reachout Sent"`;
                
                console.log('Status updated:', availableCount, 'available,', contactedCount, 'contacted');
            } catch (error) {
                console.error('Error in updateSyncStatus:', error);
                alert('Error updating status: ' + error.message);
            }
        }

        function backToStep1() {
            document.getElementById('person-selection').classList.add('hidden');
            document.getElementById('user-form').classList.remove('hidden');
            document.getElementById('person-details').classList.add('hidden');
        }

        function generatePrompt() {
            const selectedName = document.getElementById('personSelect').value;
            const googleNotes = document.getElementById('googleNotes').value.trim();

            if (!selectedName) {
                alert('Please select a person.');
                return;
            }

            const person = allPeople.find(p => p['Full Name'] === selectedName);
            if (!person) {
                alert('Person not found.');
                return;
            }

            const collegeStr = currentUser.yourCollegeinUNC ? 
                `UNC Chapel Hill's ${currentUser.yourCollegeinUNC}` : 
                "UNC Chapel Hill";

            let notesSection = "";
            if (googleNotes) {
                notesSection = `\nHere are the notes from the google search query about ${person['Full Name']}:\n\n${googleNotes}\n`;
            }

            const prompt = `Please help me generate a personalized cold email for ${person['Full Name']} based on the following information:

Google Search URL: ${person['Google Search Query']}${notesSection}

Using this information and any additional context you can provide, generate a personalized cold email using the following template (fill in the brackets with the appropriate information):

My name is ${currentUser.yourName}, and I'm a ${currentUser.yourYear} at ${collegeStr}, reaching out on behalf of a passionate team of 20+ students working to launch a UNC student-run credit union. Inspired by successful other student credit unions, our initiative aims to empower students through practical financial literacy, affordable banking services, and meaningful hands-on experience.

To turn our vision into reality, we're currently raising an initial $100,000 to cover regulatory and setup costs. We're seeking donations from alumni or others who share our commitment to financial empowerment, education, and community impact. Your support would help us provide:

- No-fee student checking and savings accounts
- Unique credit-building products to improve student financial health
- On-campus financial literacy education
- Leadership and professional growth opportunities for UNC students

We believe your support could provide substantial mutual benefits, including prominent brand visibility and recognition as a foundational supporter of UNC student success.Below are links to our tax-deductible donation link or the GoFundMe alternative to provide your support:

Tax-Deductible De Novo Donation: https://secure.givelively.org/donate/cu-de-novo-collective/shiva-rajbhandari
GoFundMe Alternative: https://www.gofundme.com/f/support-carolina-credit-union-for-unc-students

Thank you for considering this opportunity to shape the future of student finance at UNC. I look forward to hearing from you soon!

Warm regards,
${currentUser.yourName}
Carolina Credit Union Initiative

Make sure to also include that I got their contact information from the UFS Alumni Database`;

            document.getElementById('promptText').textContent = prompt;
            document.getElementById('person-selection').classList.add('hidden');
            document.getElementById('prompt-output').classList.remove('hidden');
        }

        function copyPrompt() {
            const promptText = document.getElementById('promptText').textContent;
            navigator.clipboard.writeText(promptText).then(() => {
                alert('Prompt copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy: ', err);
                alert('Failed to copy to clipboard. Please select and copy manually.');
            });
        }

        function startOver() {
            document.getElementById('person-selection').classList.remove('hidden');
            document.getElementById('prompt-output').classList.add('hidden');
            
            document.getElementById('personSelect').value = '';
            document.getElementById('googleNotes').value = '';
            document.getElementById('person-details').classList.add('hidden');
        }

        function showPersonDetails() {
            const selectedName = document.getElementById('personSelect').value;
            const personDetailsDiv = document.getElementById('person-details');
            const googleQueryLink = document.getElementById('google-query-link');

            if (!selectedName) {
                personDetailsDiv.classList.add('hidden');
                googleQueryLink.href = '';
                googleQueryLink.textContent = 'Click here to open Google search';
                return;
            }

            const person = allPeople.find(p => p['Full Name'] === selectedName);
            if (person) {
                personDetailsDiv.classList.remove('hidden');
                googleQueryLink.href = person['Google Search Query'];
                googleQueryLink.textContent = person['Google Search Query'];
            } else {
                personDetailsDiv.classList.add('hidden');
                googleQueryLink.href = '';
                googleQueryLink.textContent = 'Click here to open Google search';
            }
        }
    </script>
</body>
</html> 